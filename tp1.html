<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic CSV Sheets</title>
    <style>
        .wraper {
            display: none; /* Initially hide the sheets */
        }
        .wraper.active {
            display: block; /* Show active sheet */
        }
    </style>
</head>
<body>
    <button id="addSheet">Add Sheet</button>
    <div id="sheets">
        <!-- Buttons or elements to switch sheets -->
    </div>
    <div id="sheetContainer"></div>
    <script >
        class Excel {
    constructor(csvContent, container) {
        this.csvContent = csvContent;
        this.container = container;
        this.element = document.createElement('div');
        this.element.className = 'wraper';
        this.element.innerHTML = this.parseCSV();
        container.appendChild(this.element);
    }

    parseCSV() {
        // Basic CSV parsing implementation
        const rows = this.csvContent.trim().split('\n');
        return rows.map(row => `<div>${row}</div>`).join('');
    }

    show() {
        this.element.classList.add('active');
    }

    hide() {
        this.element.classList.remove('active');
    }
}

const csvSheets = [
    `Name,Age,Location\nAlice,30,New York\nBob,25,Los Angeles`,
    `Name,Role\nCharlie,Developer\nDana,Designer`
];

const excelInstances = [];
const sheetContainer = document.getElementById('sheetContainer');
const sheets = document.getElementById('sheets');
let activeSheetIndex = -1;

function initializeSheets() {
    csvSheets.forEach((csvContent, index) => {
        const excel = new Excel(csvContent, sheetContainer);
        excelInstances.push(excel);

        // Create a button for each sheet
        const button = document.createElement('button');
        button.innerText = `Sheet ${index + 1}`;
        button.addEventListener('click', () => showSheet(index));
        sheets.appendChild(button);
    });

    // Show the first sheet by default
    if (excelInstances.length > 0) {
        showSheet(0);
    }
}

function showSheet(index) {
    if (activeSheetIndex !== -1) {
        excelInstances[activeSheetIndex].hide();
    }

    activeSheetIndex = index;
    excelInstances[activeSheetIndex].show();
}

document.getElementById('addSheet').addEventListener('click', () => {
    const newCsv = prompt('Enter new CSV content:');
    if (newCsv) {
        const excel = new Excel(newCsv, sheetContainer);
        excelInstances.push(excel);

        // Create a new button for the added sheet
        const button = document.createElement('button');
        button.innerText = `Sheet ${excelInstances.length}`;
        button.addEventListener('click', () => showSheet(excelInstances.length - 1));
        sheets.appendChild(button);

        // Automatically switch to the new sheet
        showSheet(excelInstances.length - 1);
    }
});

// Initialize sheets on page load
initializeSheets();

    </script>
</body>
</html>
